<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Board</title>
    <link rel="stylesheet" href="style.css">
<!--    <link href="https://fonts.googleapis.com/css2?family=Concert+One&display=swap" rel="stylesheet"> -->
    <script> 
           // you  can do this with class but: 
           //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Private_class_fields
           // the private fields  feature is behind 
           // the javascript.options.experimental.private_fields preferences 
           // (needs to be set to true) and the javascript.options.experimental.private_methods
           //  preferences (needs to be set to true). To change preferences in Firefox, visit about:config.

           

           const chessTableBase = function(){
                 this.render = function(){
                     return render();
                 }
                 let pieces = {White:[],Black:[]};
                 const pieceAdd = function(color,type,position){
                      pieces[color].push({
                           'type'     : type,
                           'position' : position
                      });
                 }
                 const pieceRender  = function (color, type){
                     const piece = document.createElement('img');
                     piece.setAttribute(
                         'src',
                         `./assets/${color}${type}.png`
                     );
                    return piece
                 }
                 const pieceTo = function(color,type,position){
                      document.getElementById(
                         'cube_'+position
                      ).getElementsByTagName(
                         'div'
                      )[0].appendChild(
                         pieceRender(color, type)
                      );
                 }
                 const piecesRender  = function(){
                     for(const color in pieces)
                         for(const id in pieces[color])
                             pieceTo(
                                 color,
                                 pieces[color][id].type,
                                 pieces[color][id].position,
                            );
                 }
                 const piecesToStartPosition = function(){
                        pieces = {White:[],Black:[]};
                        for(const column of column_titles)
                             pieceAdd(
                                 'White',
                                 'Pawn',
                                 column+'2'
                             );
                        for(const column of column_titles)
                             pieceAdd(
                                 'Black',
                                 'Pawn',
                                 column+'7'
                             );
                        for(const column of ['a','h'])
                             pieceAdd(
                                 'White',
                                 'Rook',
                                 column+'1'
                             );
                        for(const column of ['a','h'])
                             pieceAdd(
                                 'Black',
                                 'Rook',
                                 column+'8'
                             );
                        for(const column of ['b','g'])
                             pieceAdd(
                                 'White',
                                 'Knight',
                                 column+'1'
                             );
                        for(const column of ['b','g'])
                             pieceAdd(
                                 'Black',
                                 'Knight',
                                 column+'8'
                             );
                        for(const column of ['c','f'])
                             pieceAdd(
                                 'White',
                                 'Bishop',
                                 column+'1'
                             );
                        for(const column of ['c','f'])
                             pieceAdd(
                                 'Black',
                                 'Bishop',
                                 column+'8'
                             );
                        pieceAdd(
                            'White',
                            'Queen',
                            'd1'
                        );
                        pieceAdd(
                            'Black',
                            'Queen',
                            'd8'
                        );
                        pieceAdd(
                            'White',
                            'King',
                            'e1'
                        );
                        pieceAdd(
                            'Black',
                            'King',
                            'e1'
                        );
                 }
                 const column_titles = ['a','b','c','d','e','f','g','h'];
                 const field = function (column_name, line_number) { 
                     const cube = document.createElement('div');
                     const card = document.createElement('div');
                     const empty = document.createElement('div');
                     cube.className = 'flip-card';
                     cube.setAttribute(
                         'id',
                         'cube_'+column_name+line_number
                     );
                     card.className = 'flip-card-back';
                     cube.appendChild(card);
                     cube.appendChild(empty);
                     return cube;

                 }
                 const column = function(column_name){
                      const section = document.createElement('section');
                      section.setAttribute(
                          'id',
                              ('column_'+column_name.toString())
                      );
                      for (let line_number = 8 ; line_number > 0 ; line_number--)
                          section.appendChild(
                              field(
                                  column_name,
                                  line_number
                              )
                          );
                      return section;

                 }
                 const table = function(){
                      const main = document.getElementsByTagName('main')[0];
                      main.innerHTML="";
                      for(const column_name of column_titles)
                          main.appendChild(
                              column(column_name)
                          );
                 }
                 const render = function(){
                     table();
                     piecesRender();
                 }
                 piecesToStartPosition();
                 render();
           }
           window.onload = function(){
                new chessTableBase();
           }
    </script>
</head>
<body>
    <main>
    </main>
</body>
</html>
